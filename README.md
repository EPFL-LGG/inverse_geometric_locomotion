<p align="center">

  <h1 align="center">Inverse Geometric Locomotion</h1>

  ![Teaser](./images/Teaser.jpg)

  <p align="center">
    <a href="https://qbecky.github.io/"><strong>Quentin Becker*</strong></a>
    · 
    <a href="https://olligross.github.io/"><strong>Oliver Gross*</strong></a>
    · 
    <a href="https://people.epfl.ch/mark.pauly"><strong>Mark Pauly</strong></a>
    <br />
    (* denotes equal contribution)
  </p>
</p>

<p align="center">
  <a href='https://infoscience.epfl.ch/entities/publication/0fdc1789-b091-4bff-ac08-60d02ec562f4'>
    <img src='https://img.shields.io/badge/Paper-PDF-red?style=flat-square' alt='Paper PDF'>
  </a>
  <a href='https://go.epfl.ch/igl/' style='padding-left: 0.5rem;'>
    <img src='https://img.shields.io/badge/Project-Page-blue?style=flat-square' alt='Project Page'>
  </a>
</p>



## About

This repository contains the source code and data for [Inverse Geometric Locomotion](https://go.epfl.ch/igl/) (IGL), published at SIGGRAPH 2025.

Tools from this repository solve the control problem of geometric locomotion *i.e.,* motion solely determined by a body's changing shape. 

[Motion From Shape Change](https://olligross.github.io/projects/MotionFromShapeChange/MotionFromShapeChange_project.html) introduces a dissipation metric unifying purely inertial (platform divers, astronauts) and dissipative setups (snake, worm, or sperm cell motion), but requires users to manually design the gaits. By introducing reduced shape spaces, space-time interpolation, and regularizations, IGL efficiently recovers a shape sequence that achieves a user-defined goal through first-order continuous optimization. See for instance the snake making its way through the obstacles to reach the flags above.

## Code Structure

The repository is structured as follows,

```
inverse_geometric_locomotion
├── data
├── ext
│   ├── geolab
│   └── torchcubicspline
├── images
├── notebooks
├── output
└── python
    ├── experiments
    │   ├── *_settings.py
    │   └── *.py
    ├── *.py
    └── *utils.py
```

In alphabetical order, 
- `data/` stores some meshes that are used in some experiments.
- `ext/` contains external libraries that are needed for the project. In our case [`geolab`](https://github.com/EPFL-LGG/geolab), which contains some useful input-output functions for geometric data, and [`torchcubicspline`](https://qbecky.github.io/miscellanea_pages/torchcubicspline.html), a [PyTorch](https://pytorch.org/)-based library that contains utilities to parameterize and optimize snake gaits using a few control points.
- `images/` contains some illustrations for this README file.
- `notebooks/` is where you can create notebooks to interactively experiment with the code. We typically use them to peak at optimization results generated by scripts in `python/experiments/`: See `snake_straight_traj_parse.ipynb` that parses and visualizes results.
- `output/` will be populated when you run experiments and is intended to store code output (forward simulation and optimization) as well as graphs, metrics, renders, etc.
- `python/` contains scripts for running experiments in parallel (in `python/experiments/`), the functions related to forward simulation and sensitivity analysis, and utilitary functions. In `python/experiments/`, we name experiment scripts and settings scripts by pairs: For instance `snake_straight_traj.py` and `snake_straight_traj_settings.py`. You can create your own experiment by following the same template.

## Installation

First, clone the repository recursively as follows

```bash
git clone --recurse-submodules -j8 git@github.com:qbecky/inverse_geometric_locomotion.git
```

Or if you already cloned the repository, run

```bash
git submodule update --init --recursive
```

Make sure you have [pandoc](https://pandoc.org/) installed on your machine. This part is only relevant for the astronaut example and can be skipped.

Simply create a conda environment and install the dependencies

```bash
conda create --name igl_env
conda activate igl_env
conda install -y scipy=1.10 matplotlib numpy=1 jupyterlab tqdm opencv absl-py
conda install -y pytorch::pytorch -c pytorch
conda install -y -c conda-forge meshplot nbstripout pypandoc
pip install ffmpeg-python
pip install libigl
pip install pygmsh
nbstripout --install
```

Note that `ffmpeg-python` might not be compatible with your os (in particular for Windows users). In that case, please install `conda install -y ffmpeg` instead.

## Run code

Simply activate your environment and run 

```
jupyter lab
```

You can also run experiments scripts in `python/experiments/` by executing the following command in a terminal inside the `experiments/` subfolder with the `igl_env` conda environment activated,

```bash
python snake_straight_traj.py --trial_number=0
```

# Citation

If you use this codebase in your project, please consider citing our work:
```
@article{becker2025igl,
  author = {Becker, Quentin and Gross, Oliver and Pauly, Mark},
  title = {Inverse Geometric Locomotion},
  year = {2025},
  issue_date = {August 2025},
  publisher = {Association for Computing Machinery},
  address = {New York, NY, USA},
  volume = {44},
  number = {4},
  issn = {0730-0301},
  url = {https://doi.org/10.1145/3731187},
  doi = {10.1145/3731187},
  journal = {ACM Trans. Graph.},
  month = jul,
  articleno = {141},
  numpages = {17},
}
```